<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Biomedical Waste Training Game</title>

<style>
    body {
        margin: 0;
        font-family: Arial, sans-serif;
        background: #f4f6ff;
        text-align: center;
    }

    /* Screens */
    #startScreen, #gameScreen, #resultScreen {
        display: none;
        padding: 20px;
    }

    /* Buttons */
    .btn {
        width: 80%;
        padding: 14px;
        margin: 10px 0;
        font-size: 18px;
        border: none;
        border-radius: 12px;
        cursor: pointer;
        background: #1e5aff;
        color: white;
    }

    .btn:hover { background: #0c3ecc; }

    .btn-green {
        background: #25D366;
    }

    /* Bins */
    .bin {
        width: 120px;
        margin: 10px;
        cursor: pointer;
    }

    /* Item image */
    #itemImage {
        width: 220px;
        height: 220px;
        background: #e8edff;
        border-radius: 12px;
        padding: 10px;
        object-fit: contain;
        margin-top: 10px;
    }

    /* Timer bar */
    #timerBarContainer {
        width: 85%;
        height: 12px;
        background: #d2d7ff;
        border-radius: 10px;
        margin: 10px auto;
    }

    #timerBar {
        height: 12px;
        background: #1e5aff;
        width: 100%;
        border-radius: 10px;
    }

    /* Footer credit */
    .footer-credit {
        margin-top: 20px;
        color: #777;
        font-size: 14px;
    }

    /* Toast */
    #toast {
        position: fixed;
        top: 20px;
        left: 50%;
        transform: translateX(-50%);
        background: #ff4444;
        color: white;
        padding: 10px 20px;
        border-radius: 10px;
        display: none;
        font-weight: bold;
    }
</style>

<!-- Confetti -->
<script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>

</head>
<body>

<div id="toast"></div>

<!-- â­ SINGLE PAGE: WELCOME + INSTRUCTIONS + DIFFICULTY -->
<div id="startScreen" style="display:block;">

    <h1>Biomedical Waste Training Game</h1>
    <p>Quick BMW segregation training for healthcare staff.</p>

    <h3>Instructions</h3>
    <p>â€¢ An item will appear on screen.</p>
    <p>â€¢ Tap the correct waste bin.</p>
    <p>â€¢ Score: +1 correct / -1 wrong.</p>

    <h3>Select Difficulty</h3>

    <button class="btn" onclick="startGame('easy')">Easy (90 sec)</button>
    <button class="btn" onclick="startGame('medium')">Medium (60 sec)</button>
    <button class="btn" onclick="startGame('hard')">Hard (30 sec)</button>

    <p class="footer-credit">Designed & Developed by <b>Gokul T.B.</b></p>
</div>


<!-- â­ GAME SCREEN (old UI preserved) -->
<div id="gameScreen">
    <h2 id="difficultyText"></h2>

    <div id="timerBarContainer"><div id="timerBar"></div></div>

    <h3>Score: <span id="scoreDisplay">0</span></h3>

    <h3 id="itemName"></h3>
    <img id="itemImage">

    <div>
        <img class="bin" src="images/redbin.jpg" onclick="checkAnswer('red')">
        <img class="bin" src="images/yellowbin.jpg" onclick="checkAnswer('yellow')">
        <img class="bin" src="images/bluebin.png" onclick="checkAnswer('blue')">
        <img class="bin" src="images/greenbin.png" onclick="checkAnswer('green')">
        <img class="bin" src="images/translucentbin.png" onclick="checkAnswer('translucent')">
    </div>
</div>


<!-- â­ RESULT SCREEN -->
<div id="resultScreen">
    <h1>ðŸŽ‰ Training Completed!</h1>
    <h2>Your Score: <span id="finalScore"></span></h2>
    <h3 id="difficultyResult"></h3>

    <button class="btn" onclick="showStart()">Play Again</button>
    <button class="btn btn-green" onclick="shareOnWhatsApp()">Share Score on WhatsApp</button>

    <p class="footer-credit">Designed & Developed by <b>Gokul T.B.</b></p>
</div>


<script>
/* ------------------------------
   SCREEN SWITCH
------------------------------ */
function showStart() {
    resultScreen.style.display = "none";
    startScreen.style.display = "block";
}

/* ------------------------------
   GAME DATA
------------------------------ */
let score = 0, timeLeft = 0, timerInterval, skipTimer, currentItem, currentLevel;

const settings = {
    easy:   { label:"Easy Mode",   time:90, skip:null },
    medium: { label:"Medium Mode", time:60, skip:5000 },
    hard:   { label:"Hard Mode",   time:30, skip:3000 }
};

const easyItems = [
    {name:"Mask", img:"images/Mask.webp", bin:"red"},
    {name:"Blood Bag", img:"images/Blood Bag.avif", bin:"yellow"},
    {name:"Vial", img:"images/Vial.jpg", bin:"blue"},
    {name:"Expired Medicines", img:"images/Expired Medicines.webp", bin:"green"}
];

const mediumItems = [
    {name:"IV Set", img:"images/IV SET.png", bin:"red"},
    {name:"Lab Slides", img:"images/Lab Slides.jpg", bin:"blue"},
    {name:"Anatomical Waste", img:"images/Human anatomical waste.webp", bin:"yellow"}
];

const hardItems = [
    {name:"Needles", img:"images/Needles.webp", bin:"translucent"},
    {name:"Blade", img:"images/Blade.webp", bin:"translucent"},
];

/* ------------------------------
   START GAME
------------------------------ */
function startGame(level) {

    currentLevel = level;
    score = 0;
    timeLeft = settings[level].time;

    startScreen.style.display = "none";
    gameScreen.style.display = "block";

    difficultyText.innerText = settings[level].label;
    scoreDisplay.innerText = score;

    startTimer();
    loadNextItem();
}

/* ------------------------------
   TIMER
------------------------------ */
function startTimer() {
    timerInterval = setInterval(() => {
        timeLeft--;
        timerBar.style.width = (timeLeft / settings[currentLevel].time * 100) + "%";

        if (timeLeft <= 0) endGame();
    }, 1000);
}

/* ------------------------------
   LOAD ITEM
------------------------------ */
function loadNextItem() {
    clearTimeout(skipTimer);

    let pool =
        currentLevel === "easy" ? easyItems :
        currentLevel === "medium" ? easyItems.concat(mediumItems) :
                                    easyItems.concat(mediumItems, hardItems);

    currentItem = pool[Math.floor(Math.random() * pool.length)];

    itemName.innerText = "Item: " + currentItem.name;
    itemImage.src = currentItem.img;

    if (settings[currentLevel].skip) {
        skipTimer = setTimeout(() => {
            score--;
            scoreDisplay.innerText = score;
            showToast("â± Auto-skip! -1");
            loadNextItem();
        }, settings[currentLevel].skip);
    }
}

/* ------------------------------
   CHECK ANSWER
------------------------------ */
function checkAnswer(bin) {
    clearTimeout(skipTimer);

    if (bin === currentItem.bin) {
        score++;
        showToast("âœ” Correct! +1");
    } else {
        score--;
        showToast("âŒ Wrong! Correct bin: " + currentItem.bin.toUpperCase());
    }

    scoreDisplay.innerText = score;
    if (timeLeft > 0) loadNextItem();
}

/* ------------------------------
   END GAME + CONFETTI
------------------------------ */
function endGame() {

    clearInterval(timerInterval);
    clearTimeout(skipTimer);

    gameScreen.style.display = "none";
    resultScreen.style.display = "block";

    finalScore.innerText = score;
    difficultyResult.innerText = settings[currentLevel].label;

    // CONFETTI (C1 minimal)
    confetti({
        particleCount: 120,
        spread: 50,
        origin: { y: 0.2 }
    });
}

/* ------------------------------
   WHATSAPP SHARE (W2)
------------------------------ */
function shareOnWhatsApp() {
    const msg =
        "I scored " + score +
        " points on " + settings[currentLevel].label +
        " in the Biomedical Waste Training Game!\nTry it here: https://creator619-python.github.io/Biomedical-Waste-Game/";

    window.open("https://wa.me/?text=" + encodeURIComponent(msg), "_blank");
}

/* ------------------------------
   TOAST
------------------------------ */
function showToast(text) {
    toast.innerText = text;
    toast.style.display = "block";
    setTimeout(() => toast.style.display = "none", 1300);
}
</script>

</body>
</html>
